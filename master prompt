You must generate a complete, production-ready municipal tax management system for Tunisia, fully aligned with the official Code de la FiscalitÃ© Locale 2025 (Taxe sur les Immeubles BÃ¢tis â€” TIB, and Taxe sur les Terrains Non BÃ¢tis â€” TTNB). Follow the law precisely (definitions, obligations, sanctions, rates, authorities, declarations, disputes).

SYSTEM SUMMARY

Build a microservices-inspired modular Flask backend with a unified frontend login page for all user roles. After login, redirect users to dashboards based on their assigned role.

ROLES (8 TOTAL â€“ MUST BE IMPLEMENTED IN FULL)

Citizen (property owner, tenantâ€”declares TIB & TTNB)

Business Owner (commercial establishmentsâ€”TIB + establishment tax)

Municipal Agent (verifies declarations, validates satellite measurements, controls infractions)

Municipal Inspector (field inspections, satellite verification, notes)

Finance Officer / Receveur des Finances (recovers taxes, issues payment attestations)

Contentieux Officer (handles disputes, oppositions, revision commission workflow)

Urbanism / Technical Service (validates building permits, construction status, classification)

Administrator (manages all accounts except citizens & businesses)

REGISTRATION RULES

Citizens & businesses can register themselves.

All other roles must be created by Admin.

AUTHENTICATION REQUIREMENTS

Use flask-jwt-extended, including:

Access & Refresh tokens

Token blacklist table

Role-based authorization decorators

Endpoint protection based on roles

Automatic logout + token revocation

ğŸ“Œ CORE FUNCTIONALITY (FULL LIST)
1. TIB Management (Taxe sur les Immeubles BÃ¢tis)

Implement all features aligned with the law, including:

Property declaration (surface couverte, composition, address, affectation)

Automatic tax calculation based on:

Article 4 (2% of reference price Ã— surface category)

Article 5 (rate based on number of services: 8%, 10%, 12%, 14%)

Penalties: Article 19

Recensement process (Articles 7â€“9)

Notifications (Article 8)

2. TTNB Management (Terrains Non BÃ¢tis)

Apply Article 33 (0.3% value or tariff if no vÃ©nale value).

Exemptions per Article 32.

Same recensement, obligations, sanctions.

3. Satellite Imagery Verification (FREE APIs ONLY)

Use:

OpenStreetMap Nominatim (free geocoding)

OpenTopoMap / OSM Tiles

USGS Landsat API (free)

NASA GIBS Tiles (free)

If a street name is not found:
â†’ Ask user for nearest known reference point OR fallback to coordinates search.
â†’ Allow municipal inspector to override manually.

4. Payment Processing

Simulate payments (no real gateway).
Finance Officer can:

Issue payment attestation (Article 13)

Verify no outstanding tax before issuing permits

Generate receipts

5. Dispute & Contentieux Workflow

Implement Articles 23â€“26 and 56:

Citizen submits dispute

Contentieux officer processes

Commission de rÃ©vision structure

Deadlines, statuses, escalation

Final ruling

6. Service Reclamations

Citizens and businesses can submit service complaints (lighting, road maintenance, drainage, etc.).
Municipal agent manages & resolves.

7. Participatory Budget Voting

Citizens vote on where municipal funds (from TIB & TTNB) should be spent.
Admin can create budget projects.
Anonymous aggregation.

8. Payment Obligations for Permits

Enforce Article 13 permit restrictions:

Construction permit

Lotissement approval

Signature legalization

Occupancy permit

System MUST block permit requests if taxes unpaid.

ğŸŒ EXTERNAL FREE APIS TO USE

All must be cost-free:

Geocoding / Address validation

Nominatim (OpenStreetMap)

Fallback: OSM reverse geocoding

Satellite imagery

NASA GIBS (free, updated daily)

USGS Landsat (free, updated monthly)

OpenTopoMap / Terrain tiles

Maps

OSM static tiles (free, no token required)

ğŸ§± PROJECT STRUCTURE (MANDATORY)
project/
â”‚â”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚
â”‚â”€â”€ backend/
â”‚   â”œâ”€â”€ app.py
â”‚   â”œâ”€â”€ extensions/
â”‚   â”‚   â”œâ”€â”€ db.py
â”‚   â”‚   â”œâ”€â”€ jwt.py
â”‚   â”‚   â”œâ”€â”€ api.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ property.py
â”‚   â”‚   â”œâ”€â”€ land.py
â”‚   â”‚   â”œâ”€â”€ tax.py
â”‚   â”‚   â”œâ”€â”€ penalty.py
â”‚   â”‚   â”œâ”€â”€ dispute.py
â”‚   â”‚   â”œâ”€â”€ payment.py
â”‚   â”‚   â”œâ”€â”€ permit.py
â”‚   â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â”œâ”€â”€ auth.py
â”‚   â”‚   â”œâ”€â”€ tib.py
â”‚   â”‚   â”œâ”€â”€ ttnb.py
â”‚   â”‚   â”œâ”€â”€ dispute.py
â”‚   â”‚   â”œâ”€â”€ payment.py
â”‚   â”‚   â”œâ”€â”€ permits.py
â”‚   â”‚   â”œâ”€â”€ admin.py
â”‚   â”‚   â”œâ”€â”€ inspector.py
â”‚   â”‚   â”œâ”€â”€ finance.py
â”‚   â”‚   â”œâ”€â”€ reclamations.py
â”‚   â”‚   â”œâ”€â”€ budget_voting.py
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ geo.py
â”‚   â”‚   â”œâ”€â”€ calculator.py
â”‚   â”‚   â”œâ”€â”€ validators.py
â”‚   â”‚   â”œâ”€â”€ role_required.py
â”‚
â”‚â”€â”€ frontend/
â”‚   â”œâ”€â”€ common_login/
â”‚   â”œâ”€â”€ dashboards/
â”‚   â”‚   â”œâ”€â”€ citizen/
â”‚   â”‚   â”œâ”€â”€ business/
â”‚   â”‚   â”œâ”€â”€ inspector/
â”‚   â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ finance/
â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”œâ”€â”€ contentieux/
â”‚   â”‚   â”œâ”€â”€ urbanism/
â”‚
â”‚â”€â”€ tests/
â”‚   â”œâ”€â”€ insomnia_collection.json
â”‚
â”‚â”€â”€ README.md

ğŸ“¡ ENDPOINT LIST (FULL)
Auth

POST /auth/register-citizen

POST /auth/register-business

POST /auth/login

POST /auth/refresh

POST /auth/logout

Admin

POST /admin/create-user

GET /admin/users

PATCH /admin/user/{id}

DELETE /admin/user/{id}

Citizen / Business

POST /properties

GET /properties

POST /lands

GET /lands

GET /taxes/my

POST /payments/pay

GET /payments/attestation

Municipal Agent

GET /verification/address

POST /verification/property

POST /verification/land

Inspector

POST /inspection/report

GET /inspection/{id}

Finance Officer

GET /finance/debtors

POST /finance/attestation/{user_id}

Contentieux

POST /disputes

GET /disputes

PATCH /disputes/{id}/decision

Urbanism

POST /permits/request

GET /permits/status

Reclamations

POST /reclamations

GET /reclamations

Participatory Budget

POST /budget/projects

GET /budget/projects

POST /budget/projects/{id}/vote

ğŸ“¦ TECHNICAL REQUIREMENTS
Backend Framework

Flask

flask-smorest (for OpenAPI + blueprints)

flask-jwt-extended

marshmallow

SQLAlchemy

Docker

Backend + frontend must run through Docker Compose.
Backend image must auto-migrate DB on startup.

Insomnia Collection

Generate a complete insomnia_collection.json with:

Auth flows

Token renewal

Property declaration

Satellite validation

Disputes

Voting

Payments

Permits

Reclamations

âš ï¸ ERROR HANDLING

If street name not found:

return {
  "error": "Street not found in external API",
  "suggestion": "Try the nearest known street or provide GPS coordinates"
}

ğŸ§  WHAT COPILOT MUST PRODUCE

Full backend code

Frontend templates + role-based dashboards

Dockerized application

JWT system with refresh + blacklist

All endpoints described above

Data models reflecting Tunisian municipal tax law

Automated tax calculator compliant with Articles 1â€“34, 52â€“56

Insomnia API collection

Complete documentation via Swagger (flask-smorest)